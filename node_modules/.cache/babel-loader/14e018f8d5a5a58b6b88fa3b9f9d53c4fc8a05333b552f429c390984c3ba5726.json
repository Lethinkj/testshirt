{"ast":null,"code":"var _jsxFileName = \"D:\\\\tshirt2\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useEffect, useState } from 'react';\nimport { supabase } from '../supabaseClient';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [role, setRole] = useState(null);\n  useEffect(() => {\n    supabase.auth.getSession().then(({\n      data: {\n        session\n      }\n    }) => {\n      var _session$user;\n      setUser((_session$user = session === null || session === void 0 ? void 0 : session.user) !== null && _session$user !== void 0 ? _session$user : null);\n      if (session !== null && session !== void 0 && session.user) fetchRole(session.user.id);\n    });\n    const {\n      data: listener\n    } = supabase.auth.onAuthStateChange((_event, session) => {\n      var _session$user2;\n      setUser((_session$user2 = session === null || session === void 0 ? void 0 : session.user) !== null && _session$user2 !== void 0 ? _session$user2 : null);\n      if (session !== null && session !== void 0 && session.user) fetchRole(session.user.id);\n    });\n    return () => listener.subscription.unsubscribe();\n  }, []);\n  const fetchRole = async id => {\n    const {\n      data\n    } = await supabase.from('profiles').select('role').eq('id', id).single();\n    setRole((data === null || data === void 0 ? void 0 : data.role) || 'user');\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      role,\n      fetchRole\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 10\n  }, this);\n};\n_s(AuthProvider, \"iTY3qP3pH2KEmGVhPeeHSfaPq48=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","supabase","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","role","setRole","auth","getSession","then","data","session","_session$user","fetchRole","id","listener","onAuthStateChange","_event","_session$user2","subscription","unsubscribe","from","select","eq","single","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/tshirt2/src/context/AuthContext.js"],"sourcesContent":["import { createContext, useEffect, useState } from 'react';\nimport { supabase } from '../supabaseClient';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [role, setRole] = useState(null);\n\n  useEffect(() => {\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      setUser(session?.user ?? null);\n      if (session?.user) fetchRole(session.user.id);\n    });\n\n    const { data: listener } = supabase.auth.onAuthStateChange((_event, session) => {\n      setUser(session?.user ?? null);\n      if (session?.user) fetchRole(session.user.id);\n    });\n\n    return () => listener.subscription.unsubscribe();\n  }, []);\n\n  const fetchRole = async (id) => {\n    const { data } = await supabase.from('profiles').select('role').eq('id', id).single();\n    setRole(data?.role || 'user');\n  };\n\n  return <AuthContext.Provider value={{ user, role, fetchRole }}>{children}</AuthContext.Provider>;\n};"],"mappings":";;AAAA,SAASA,aAAa,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC1D,SAASC,QAAQ,QAAQ,mBAAmB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7C,OAAO,MAAMC,WAAW,gBAAGN,aAAa,CAAC,CAAC;AAE1C,OAAO,MAAMO,YAAY,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EAC5C,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGT,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAACU,IAAI,EAAEC,OAAO,CAAC,GAAGX,QAAQ,CAAC,IAAI,CAAC;EAEtCD,SAAS,CAAC,MAAM;IACdE,QAAQ,CAACW,IAAI,CAACC,UAAU,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;MAAEC,IAAI,EAAE;QAAEC;MAAQ;IAAE,CAAC,KAAK;MAAA,IAAAC,aAAA;MACzDR,OAAO,EAAAQ,aAAA,GAACD,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAER,IAAI,cAAAS,aAAA,cAAAA,aAAA,GAAI,IAAI,CAAC;MAC9B,IAAID,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAER,IAAI,EAAEU,SAAS,CAACF,OAAO,CAACR,IAAI,CAACW,EAAE,CAAC;IAC/C,CAAC,CAAC;IAEF,MAAM;MAAEJ,IAAI,EAAEK;IAAS,CAAC,GAAGnB,QAAQ,CAACW,IAAI,CAACS,iBAAiB,CAAC,CAACC,MAAM,EAAEN,OAAO,KAAK;MAAA,IAAAO,cAAA;MAC9Ed,OAAO,EAAAc,cAAA,GAACP,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAER,IAAI,cAAAe,cAAA,cAAAA,cAAA,GAAI,IAAI,CAAC;MAC9B,IAAIP,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAER,IAAI,EAAEU,SAAS,CAACF,OAAO,CAACR,IAAI,CAACW,EAAE,CAAC;IAC/C,CAAC,CAAC;IAEF,OAAO,MAAMC,QAAQ,CAACI,YAAY,CAACC,WAAW,CAAC,CAAC;EAClD,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMP,SAAS,GAAG,MAAOC,EAAE,IAAK;IAC9B,MAAM;MAAEJ;IAAK,CAAC,GAAG,MAAMd,QAAQ,CAACyB,IAAI,CAAC,UAAU,CAAC,CAACC,MAAM,CAAC,MAAM,CAAC,CAACC,EAAE,CAAC,IAAI,EAAET,EAAE,CAAC,CAACU,MAAM,CAAC,CAAC;IACrFlB,OAAO,CAAC,CAAAI,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEL,IAAI,KAAI,MAAM,CAAC;EAC/B,CAAC;EAED,oBAAOP,OAAA,CAACC,WAAW,CAAC0B,QAAQ;IAACC,KAAK,EAAE;MAAEvB,IAAI;MAAEE,IAAI;MAAEQ;IAAU,CAAE;IAAAZ,QAAA,EAAEA;EAAQ;IAAA0B,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAuB,CAAC;AAClG,CAAC;AAAC5B,EAAA,CAxBWF,YAAY;AAAA+B,EAAA,GAAZ/B,YAAY;AAAA,IAAA+B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}